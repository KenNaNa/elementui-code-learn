# 使用RxJS创建一个可观察对象

给一个按钮绑定点击事件，在原生 js 我们需要使用 addEventListener, 有了 Rxjs 我们就可以用 RXjs 来创建一个可观察对象

```html
<button id="btn" (click)="clickMe()">点我</button>
```

```js
import { from, fromEvent } from 'rxjs';

// 测试代码
clickMe(): void {
  const oBtn = document.querySelector('#btn');
  const obr = fromEvent(oBtn, 'click');
  obr.subscribe((e) => console.log(e));
}
```

# combineAll

```ts
import { take, map, combineAll } from 'rxjs/operators';
import { interval } from 'rxjs';
// 每秒发出值，并只取前2个
    const source = interval(1000).pipe(take(2));
    // 将 source 发出的每个值映射成取前5个值的 interval observable
    const example = source.pipe(
      map((val) =>
        interval(1000).pipe(
          map((i) => `Result (${val}): ${i}`),
          take(5)
        )
      )
    );
    /*
  soure 中的2个值会被映射成2个(内部的) interval observables，
  这2个内部 observables 每秒使用 combineLatest 策略来 combineAll，
  每当任意一个内部 observable 发出值，就会发出每个内部 observable 的最新值。
*/
    const combined = example.pipe(combineAll());
    /*
  输出:
  ["Result (0): 0", "Result (1): 0"]
  ["Result (0): 1", "Result (1): 0"]
  ["Result (0): 1", "Result (1): 1"]
  ["Result (0): 2", "Result (1): 1"]
  ["Result (0): 2", "Result (1): 2"]
  ["Result (0): 3", "Result (1): 2"]
  ["Result (0): 3", "Result (1): 3"]
  ["Result (0): 4", "Result (1): 3"]
  ["Result (0): 4", "Result (1): 4"]
*/
    const subscribe = combined.subscribe((val) => console.log(val));
```

# concat

按照顺序，前一个 observable 完成了再订阅下一个 observable 并发出值。

```ts
import { concat } from 'rxjs/operators';
import { of } from 'rxjs';
// 发出 1,2,3
const sourceOne = of(1, 2, 3);
// 发出 4,5,6
const sourceTwo = of(4, 5, 6);
// 先发出 sourceOne 的值，当完成时订阅 sourceTwo
const example = sourceOne.pipe(concat(sourceTwo));
// 输出: 1,2,3,4,5,6
const subscribe = example.subscribe((val) =>
  console.log('Example: Basic concat:', val)
);
```
效果
```
Example: Basic concat: 1
Example: Basic concat: 2
Example: Basic concat: 3
Example: Basic concat: 4
Example: Basic concat: 5
Example: Basic concat: 6
```
# concatAll

收集 observables，当前一个完成时订阅下一个。

```ts
import { map, concatAll } from 'rxjs/operators';
import { of, interval } from 'rxjs';
// 每2秒发出值
const source = interval(2000);
const example = source.pipe(
  // 为了演示，增加10并作为 observable 返回
  map(val => of(val + 10)),
  // 合并内部 observables 的值
  concatAll()
);
// 输出: 'Example with Basic Observable 10', 'Example with Basic Observable 11'...
const subscribe = example.subscribe(val =>
  console.log('Example with Basic Observable:', val)
);
```

